// Generated by BUCKLESCRIPT VERSION 4.0.14, PLEASE EDIT WITH CARE
'use strict';

var Game = require("./Game.bs.js");
var Json = require("@glennsl/bs-json/src/Json.bs.js");
var List = require("bs-platform/lib/js/list.js");
var $$Array = require("bs-platform/lib/js/array.js");
var Block = require("bs-platform/lib/js/block.js");
var Curry = require("bs-platform/lib/js/curry.js");
var Utils = require("./Utils.bs.js");
var Axios = require("axios");
var Belt_Id = require("bs-platform/lib/js/belt_Id.js");
var Js_null = require("bs-platform/lib/js/js_null.js");
var Tea_app = require("bucklescript-tea/src-ocaml/tea_app.js");
var Tea_cmd = require("bucklescript-tea/src-ocaml/tea_cmd.js");
var Tea_sub = require("bucklescript-tea/src-ocaml/tea_sub.js");
var Belt_Map = require("bs-platform/lib/js/belt_Map.js");
var Caml_obj = require("bs-platform/lib/js/caml_obj.js");
var Tea_html2 = require("bucklescript-tea/src-ocaml/tea_html2.js");
var Caml_array = require("bs-platform/lib/js/caml_array.js");
var Belt_Option = require("bs-platform/lib/js/belt_Option.js");
var Caml_format = require("bs-platform/lib/js/caml_format.js");
var Caml_option = require("bs-platform/lib/js/caml_option.js");
var Json_decode = require("@glennsl/bs-json/src/Json_decode.bs.js");

var cmp = Caml_obj.caml_compare;

var CmpGameId = Belt_Id.MakeComparable(/* module */[/* cmp */cmp]);

function isPublic(param_0) {
  return /* IsPublic */Block.__(0, [param_0]);
}

function allowSpectators(param_0) {
  return /* AllowSpectators */Block.__(1, [param_0]);
}

function password(param_0) {
  return /* Password */Block.__(2, [param_0]);
}

function selectGame(param_0) {
  return /* SelectGame */Block.__(0, [param_0]);
}

function updateConfig(param_0) {
  return /* UpdateConfig */Block.__(1, [param_0]);
}

function hostGameData(param_0) {
  return /* HostGameData */Block.__(2, [param_0]);
}

function post_request(result_to_message, url, data) {
  return Tea_cmd.call((function (callbacks) {
                var enqRes = function (result) {
                  return Curry._1(callbacks[0][/* enqueue */0], Curry._1(result_to_message, result));
                };
                var enqResOk = function (result) {
                  return enqRes(/* Ok */Block.__(0, [Curry._1(Utils.StringId[/* of_string */1], result.data.data.id)]));
                };
                Axios.post(url, data).then((function (param) {
                          return Utils.$less$less((function (prim) {
                                        return Promise.resolve(prim);
                                      }), enqResOk, param);
                        })).catch((function (error) {
                        return Promise.resolve(enqRes(/* Error */Block.__(1, [error])));
                      }));
                return /* () */0;
              }));
}

var default_config = /* record */[
  /* is_public */false,
  /* allow_spectators */false,
  /* password */undefined
];

function update_config(config, param) {
  switch (param.tag | 0) {
    case 0 : 
        if (param[0]) {
          return /* record */[
                  /* is_public */true,
                  /* allow_spectators */config[/* allow_spectators */1],
                  /* password */undefined
                ];
        } else {
          return /* record */[
                  /* is_public */false,
                  /* allow_spectators */config[/* allow_spectators */1],
                  /* password */config[/* password */2]
                ];
        }
    case 1 : 
        return /* record */[
                /* is_public */config[/* is_public */0],
                /* allow_spectators */param[0],
                /* password */config[/* password */2]
              ];
    case 2 : 
        return /* record */[
                /* is_public */config[/* is_public */0],
                /* allow_spectators */config[/* allow_spectators */1],
                /* password */param[0]
              ];
    
  }
}

function update(model, param) {
  if (typeof param === "number") {
    if (param === 0) {
      var selected_game = Caml_format.caml_int_of_string(Curry._1(Game.GameId[/* to_string */0], Belt_Option.getExn(model[/* selected_game */1])));
      var payload = {
        game_id: selected_game,
        configuration: {
          is_public: model[/* config */2][/* is_public */0],
          password: Js_null.fromOption(model[/* config */2][/* password */2]),
          allow_spectators: model[/* config */2][/* allow_spectators */1]
        }
      };
      return /* tuple */[
              /* record */[
                /* games */model[/* games */0],
                /* selected_game */model[/* selected_game */1],
                /* config */model[/* config */2],
                /* valid_form */model[/* valid_form */3],
                /* hosted_game_url : Fetching */1,
                /* url_copied */model[/* url_copied */5]
              ],
              post_request(hostGameData, "/api/hosted-games", payload)
            ];
    } else {
      return /* tuple */[
              /* record */[
                /* games */model[/* games */0],
                /* selected_game */model[/* selected_game */1],
                /* config */model[/* config */2],
                /* valid_form */model[/* valid_form */3],
                /* hosted_game_url */model[/* hosted_game_url */4],
                /* url_copied */true
              ],
              Tea_cmd.none
            ];
    }
  } else {
    switch (param.tag | 0) {
      case 0 : 
          return /* tuple */[
                  /* record */[
                    /* games */model[/* games */0],
                    /* selected_game */Caml_option.some(param[0]),
                    /* config */default_config,
                    /* valid_form */true,
                    /* hosted_game_url */model[/* hosted_game_url */4],
                    /* url_copied */model[/* url_copied */5]
                  ],
                  Tea_cmd.none
                ];
      case 1 : 
          var config = update_config(model[/* config */2], param[0]);
          var match = config[/* password */2];
          var valid_form = match !== undefined ? match.length >= 6 : true;
          return /* tuple */[
                  /* record */[
                    /* games */model[/* games */0],
                    /* selected_game */model[/* selected_game */1],
                    /* config */config,
                    /* valid_form */valid_form,
                    /* hosted_game_url */model[/* hosted_game_url */4],
                    /* url_copied */model[/* url_copied */5]
                  ],
                  Tea_cmd.none
                ];
      case 2 : 
          var match$1 = param[0];
          if (match$1.tag) {
            return /* tuple */[
                    /* record */[
                      /* games */model[/* games */0],
                      /* selected_game */model[/* selected_game */1],
                      /* config */model[/* config */2],
                      /* valid_form */model[/* valid_form */3],
                      /* hosted_game_url : FetchError */Block.__(1, ["(Http.string_of_error reason)"]),
                      /* url_copied */model[/* url_copied */5]
                    ],
                    Tea_cmd.none
                  ];
          } else {
            return /* tuple */[
                    /* record */[
                      /* games */model[/* games */0],
                      /* selected_game */model[/* selected_game */1],
                      /* config */model[/* config */2],
                      /* valid_form */model[/* valid_form */3],
                      /* hosted_game_url : FetchSuccess */Block.__(0, [match$1[0]]),
                      /* url_copied */model[/* url_copied */5]
                    ],
                    Tea_cmd.none
                  ];
          }
      
    }
  }
}

function player_count(min, max) {
  var exit = 0;
  if (min !== 1 || max !== 1) {
    exit = 1;
  } else {
    return "1 player";
  }
  if (exit === 1) {
    if (min === max) {
      return String(min) + " players";
    } else {
      return String(min) + (" - " + (String(max) + " players"));
    }
  }
  
}

function view_game(param) {
  if (param !== undefined) {
    var game = param;
    var desc_text = Belt_Option.getWithDefault(game[/* description */3], "No description available");
    var player_count$1 = player_count(game[/* min_players */4], game[/* max_players */5]);
    var description = desc_text + (" For " + (player_count$1 + "."));
    return Tea_html2.div(undefined, undefined, /* :: */[
                Tea_html2.Attributes[/* class' */3]("game-info"),
                /* [] */0
              ], /* :: */[
                Tea_html2.h3(undefined, undefined, /* :: */[
                      Tea_html2.Attributes[/* class' */3]("game__title"),
                      /* [] */0
                    ], /* :: */[
                      Tea_html2.text(game[/* title */1]),
                      /* [] */0
                    ]),
                /* :: */[
                  Tea_html2.h4(undefined, undefined, /* :: */[
                        Tea_html2.Attributes[/* class' */3]("game__author"),
                        /* [] */0
                      ], /* :: */[
                        Tea_html2.text("By " + game[/* author */2]),
                        /* [] */0
                      ]),
                  /* :: */[
                    Tea_html2.p(undefined, undefined, /* :: */[
                          Tea_html2.Attributes[/* class' */3]("game__description"),
                          /* [] */0
                        ], /* :: */[
                          Tea_html2.text(description),
                          /* [] */0
                        ]),
                    /* [] */0
                  ]
                ]
              ]);
  } else {
    return Tea_html2.p(undefined, undefined, /* [] */0, /* :: */[
                Tea_html2.text("Game not available."),
                /* [] */0
              ]);
  }
}

function view_config_form(model) {
  var match = model[/* config */2][/* password */2];
  var match$1 = model[/* hosted_game_url */4];
  return Tea_html2.fieldset(undefined, undefined, /* :: */[
              Tea_html2.Attributes[/* disabled */19](model[/* hosted_game_url */4] === /* Fetching */1),
              /* [] */0
            ], /* :: */[
              Tea_html2.div(undefined, undefined, /* :: */[
                    Tea_html2.Attributes[/* class' */3]("form-group form-check mb-1"),
                    /* [] */0
                  ], /* :: */[
                    Tea_html2.input$prime(undefined, undefined, /* :: */[
                          Tea_html2.Attributes[/* type' */8]("checkbox"),
                          /* :: */[
                            Tea_html2.Attributes[/* class' */3]("form-check-input"),
                            /* :: */[
                              Tea_html2.Attributes[/* id */5]("isPublic"),
                              /* :: */[
                                Tea_html2.Events[/* onCheck */19](undefined, (function (param) {
                                        return Utils.$less$less(updateConfig, isPublic, param);
                                      })),
                                /* :: */[
                                  Tea_html2.Attributes[/* checked */11](model[/* config */2][/* is_public */0]),
                                  /* [] */0
                                ]
                              ]
                            ]
                          ]
                        ], /* [] */0),
                    /* :: */[
                      Tea_html2.label(undefined, undefined, /* :: */[
                            Utils.htmlFor("isPublic"),
                            /* :: */[
                              Tea_html2.Attributes[/* class' */3]("form-check-label "),
                              /* [] */0
                            ]
                          ], /* :: */[
                            Tea_html2.text("List publicly?"),
                            /* [] */0
                          ]),
                      /* [] */0
                    ]
                  ]),
              /* :: */[
                Tea_html2.div(undefined, undefined, /* :: */[
                      Tea_html2.Attributes[/* class' */3]("form-group form-check mb-1"),
                      /* [] */0
                    ], /* :: */[
                      Tea_html2.input$prime(undefined, undefined, /* :: */[
                            Tea_html2.Attributes[/* type' */8]("checkbox"),
                            /* :: */[
                              Tea_html2.Attributes[/* class' */3]("form-check-input"),
                              /* :: */[
                                Tea_html2.Attributes[/* id */5]("allowSpectators"),
                                /* :: */[
                                  Tea_html2.Events[/* onCheck */19](undefined, (function (param) {
                                          return Utils.$less$less(updateConfig, allowSpectators, param);
                                        })),
                                  /* :: */[
                                    Tea_html2.Attributes[/* checked */11](model[/* config */2][/* allow_spectators */1]),
                                    /* [] */0
                                  ]
                                ]
                              ]
                            ]
                          ], /* [] */0),
                      /* :: */[
                        Tea_html2.label(undefined, undefined, /* :: */[
                              Utils.htmlFor("allowSpectators"),
                              /* :: */[
                                Tea_html2.Attributes[/* class' */3]("form-check-label"),
                                /* [] */0
                              ]
                            ], /* :: */[
                              Tea_html2.text("Allow spectators?"),
                              /* [] */0
                            ]),
                        /* [] */0
                      ]
                    ]),
                /* :: */[
                  Tea_html2.div(undefined, undefined, /* :: */[
                        Tea_html2.Attributes[/* class' */3]("form-group form-check"),
                        /* [] */0
                      ], /* :: */[
                        Tea_html2.input$prime(undefined, undefined, /* :: */[
                              Tea_html2.Attributes[/* type' */8]("checkbox"),
                              /* :: */[
                                Tea_html2.Attributes[/* class' */3]("form-check-input"),
                                /* :: */[
                                  Tea_html2.Attributes[/* id */5]("requirePassword"),
                                  /* :: */[
                                    Tea_html2.Attributes[/* disabled */19](model[/* config */2][/* is_public */0]),
                                    /* :: */[
                                      Tea_html2.Events[/* onCheck */19](undefined, (function (is_checked) {
                                              if (is_checked) {
                                                return Utils.$less$less(updateConfig, password, "");
                                              } else {
                                                return Utils.$less$less(updateConfig, password, undefined);
                                              }
                                            })),
                                      /* :: */[
                                        Tea_html2.Attributes[/* checked */11](Belt_Option.isSome(model[/* config */2][/* password */2])),
                                        /* [] */0
                                      ]
                                    ]
                                  ]
                                ]
                              ]
                            ], /* [] */0),
                        /* :: */[
                          Tea_html2.label(undefined, undefined, /* :: */[
                                Utils.htmlFor("requirePassword"),
                                /* :: */[
                                  Tea_html2.Attributes[/* class' */3]("form-check-label"),
                                  /* [] */0
                                ]
                              ], /* :: */[
                                Tea_html2.text("Require password to join?"),
                                /* [] */0
                              ]),
                          /* [] */0
                        ]
                      ]),
                  /* :: */[
                    match !== undefined ? Tea_html2.div(undefined, undefined, /* :: */[
                            Tea_html2.Attributes[/* class' */3]("form-group mb-4"),
                            /* [] */0
                          ], /* :: */[
                            Tea_html2.label(undefined, undefined, /* :: */[
                                  Utils.htmlFor("password"),
                                  /* [] */0
                                ], /* :: */[
                                  Tea_html2.text("Password (at least 6 characters)"),
                                  /* [] */0
                                ]),
                            /* :: */[
                              Tea_html2.input$prime(undefined, undefined, /* :: */[
                                    Tea_html2.Attributes[/* type' */8]("password"),
                                    /* :: */[
                                      Tea_html2.Attributes[/* id */5]("password"),
                                      /* :: */[
                                        Tea_html2.Attributes[/* class' */3]("form-control"),
                                        /* :: */[
                                          Tea_html2.Attributes[/* value */9](match),
                                          /* :: */[
                                            Tea_html2.Events[/* onInput */17](undefined, (function (param) {
                                                    return Utils.$less$less((function (param) {
                                                                  return Utils.$less$less(updateConfig, password, param);
                                                                }), Utils.some, param);
                                                  })),
                                            /* [] */0
                                          ]
                                        ]
                                      ]
                                    ]
                                  ], /* [] */0),
                              /* [] */0
                            ]
                          ]) : Tea_html2.noNode,
                    /* :: */[
                      Tea_html2.button(undefined, undefined, /* :: */[
                            Tea_html2.Attributes[/* class' */3]("btn btn-primary"),
                            /* :: */[
                              Tea_html2.Attributes[/* disabled */19](!model[/* valid_form */3]),
                              /* :: */[
                                Tea_html2.Events[/* onClick */8](/* HostGame */0),
                                /* [] */0
                              ]
                            ]
                          ], /* :: */[
                            Tea_html2.text("Host Game"),
                            /* :: */[
                              typeof match$1 === "number" && match$1 !== 0 ? Tea_html2.div(undefined, undefined, /* :: */[
                                      Tea_html2.Attributes[/* class' */3]("ml-2 mb-1 spinner-border spinner-border-sm"),
                                      /* [] */0
                                    ], /* [] */0) : Tea_html2.noNode,
                              /* [] */0
                            ]
                          ]),
                      /* [] */0
                    ]
                  ]
                ]
              ]
            ]);
}

function view_hosted_game(url, url_copied) {
  var url$1 = Curry._1(Utils.StringId[/* to_string */0], url);
  return Tea_html2.div(undefined, undefined, /* [] */0, /* :: */[
              Tea_html2.h4(undefined, undefined, /* :: */[
                    Tea_html2.Attributes[/* class' */3]("host-success"),
                    /* [] */0
                  ], /* :: */[
                    Tea_html2.text("Success!"),
                    /* [] */0
                  ]),
              /* :: */[
                Tea_html2.h4(undefined, undefined, /* :: */[
                      Tea_html2.Attributes[/* class' */3]("host-success-message"),
                      /* [] */0
                    ], /* :: */[
                      Tea_html2.text("Your game can be found at:"),
                      /* [] */0
                    ]),
                /* :: */[
                  Tea_html2.div(undefined, undefined, /* :: */[
                        Tea_html2.Attributes[/* class' */3]("input-group mt-2 mb-3"),
                        /* [] */0
                      ], /* :: */[
                        Tea_html2.input$prime(undefined, undefined, /* :: */[
                              Tea_html2.Attributes[/* type' */8]("text"),
                              /* :: */[
                                Utils.readonly(true),
                                /* :: */[
                                  Tea_html2.Attributes[/* class' */3]("form-control hosted-url-container no-focus-shadow"),
                                  /* :: */[
                                    Tea_html2.Attributes[/* value */9]("http://play.marrow.dk/" + url$1),
                                    /* [] */0
                                  ]
                                ]
                              ]
                            ], /* [] */0),
                        /* :: */[
                          Tea_html2.div(undefined, undefined, /* :: */[
                                Tea_html2.Attributes[/* class' */3]("input-group-append"),
                                /* [] */0
                              ], /* :: */[
                                Tea_html2.button(undefined, undefined, /* :: */[
                                      Tea_html2.Attributes[/* class' */3]("btn btn-info btn-sm no-focus-shadow"),
                                      /* :: */[
                                        Tea_html2.Events[/* onClick */8](/* CopyUrl */1),
                                        /* [] */0
                                      ]
                                    ], /* :: */[
                                      Tea_html2.text(url_copied ? "Copied" : "Copy"),
                                      /* :: */[
                                        Tea_html2.i(undefined, undefined, /* :: */[
                                              Tea_html2.Attributes[/* class' */3]("ml-2 fas " + (
                                                    url_copied ? "fa-check" : "fa-copy"
                                                  )),
                                              /* [] */0
                                            ], /* [] */0),
                                        /* [] */0
                                      ]
                                    ]),
                                /* [] */0
                              ]),
                          /* [] */0
                        ]
                      ]),
                  /* :: */[
                    Tea_html2.p(undefined, undefined, /* :: */[
                          Tea_html2.Attributes[/* class' */3]("mb-0"),
                          /* [] */0
                        ], /* :: */[
                          Tea_html2.text("Share the link with other people to allow them to play. The game will be held on the server for one week, after which the link will expire."),
                          /* [] */0
                        ]),
                    /* [] */0
                  ]
                ]
              ]
            ]);
}

function view_host_error(param) {
  if (typeof param === "number" || param.tag !== 1) {
    return Tea_html2.noNode;
  } else {
    return Tea_html2.p(undefined, undefined, /* :: */[
                Tea_html2.Attributes[/* class' */3]("text-danger"),
                /* [] */0
              ], /* :: */[
                Tea_html2.text("Failed to host game. " + param[0]),
                /* [] */0
              ]);
  }
}

function view(model) {
  var games = Belt_Map.reduce(model[/* games */0], /* [] */0, (function (acc, _k, v) {
          return /* :: */[
                  v,
                  acc
                ];
        }));
  var current_game = Belt_Option.flatMap(model[/* selected_game */1], (function (game) {
          return Belt_Map.get(model[/* games */0], game);
        }));
  var match = model[/* hosted_game_url */4];
  var tmp;
  var exit = 0;
  if (typeof match === "number" || match.tag) {
    exit = 1;
  } else {
    tmp = Tea_html2.noNode;
  }
  if (exit === 1) {
    tmp = Tea_html2.p(undefined, undefined, /* :: */[
          Tea_html2.Attributes[/* class' */3]("mb-2"),
          /* [] */0
        ], /* :: */[
          Tea_html2.text("You can host a game to play online against others. Select one below and get playing!"),
          /* [] */0
        ]);
  }
  var match$1 = model[/* hosted_game_url */4];
  var tmp$1;
  var exit$1 = 0;
  if (typeof match$1 === "number" || match$1.tag) {
    exit$1 = 1;
  } else {
    tmp$1 = view_hosted_game(match$1[0], model[/* url_copied */5]);
  }
  if (exit$1 === 1) {
    var partial_arg = Game.GameId[/* of_string */1];
    tmp$1 = Tea_html2.div(undefined, undefined, /* :: */[
          Tea_html2.Attributes[/* class' */3]("form-group"),
          /* [] */0
        ], /* :: */[
          Tea_html2.label(undefined, undefined, /* :: */[
                Utils.htmlFor("game"),
                /* [] */0
              ], /* :: */[
                Tea_html2.text("Choose game:"),
                /* [] */0
              ]),
          /* :: */[
            Tea_html2.select(undefined, undefined, /* :: */[
                  Tea_html2.Attributes[/* name */27]("game"),
                  /* :: */[
                    Tea_html2.Attributes[/* id */5]("game"),
                    /* :: */[
                      Tea_html2.Attributes[/* disabled */19](model[/* hosted_game_url */4] === /* Fetching */1),
                      /* :: */[
                        Tea_html2.Attributes[/* class' */3]("form-control"),
                        /* :: */[
                          Tea_html2.Events[/* onInput */17](undefined, (function (param) {
                                  return Utils.$less$less(selectGame, partial_arg, param);
                                })),
                          /* [] */0
                        ]
                      ]
                    ]
                  ]
                ], List.map((function (game) {
                        var partial_arg = game[/* id */0];
                        return Tea_html2.option$prime(undefined, undefined, /* :: */[
                                    Tea_html2.Attributes[/* value */9](Curry._1(Game.GameId[/* to_string */0], game[/* id */0])),
                                    /* :: */[
                                      Tea_html2.Attributes[/* selected */13](Belt_Option.mapWithDefault(model[/* selected_game */1], false, (function (param) {
                                                  return partial_arg === param;
                                                }))),
                                      /* [] */0
                                    ]
                                  ], /* :: */[
                                    Tea_html2.text(game[/* title */1]),
                                    /* [] */0
                                  ]);
                      }), games)),
            /* [] */0
          ]
        ]);
  }
  var match$2 = model[/* hosted_game_url */4];
  var tmp$2;
  var exit$2 = 0;
  if (typeof match$2 === "number" || match$2.tag) {
    exit$2 = 1;
  } else {
    tmp$2 = /* :: */[
      Tea_html2.noNode,
      /* [] */0
    ];
  }
  if (exit$2 === 1) {
    tmp$2 = /* :: */[
      view_game(current_game),
      /* :: */[
        view_host_error(model[/* hosted_game_url */4]),
        /* :: */[
          view_config_form(model),
          /* [] */0
        ]
      ]
    ];
  }
  return Tea_html2.div(undefined, undefined, /* :: */[
              Tea_html2.Attributes[/* class' */3]("hero-container"),
              /* [] */0
            ], /* :: */[
              Tea_html2.div(undefined, undefined, /* :: */[
                    Tea_html2.Attributes[/* class' */3]("hero-modal"),
                    /* [] */0
                  ], /* :: */[
                    Tea_html2.div(undefined, undefined, /* :: */[
                          Tea_html2.Attributes[/* class' */3]("hero-modal__top"),
                          /* [] */0
                        ], /* :: */[
                          Tea_html2.h1(undefined, undefined, /* :: */[
                                Tea_html2.Attributes[/* class' */3]("logo"),
                                /* [] */0
                              ], /* :: */[
                                Tea_html2.text("Marrow"),
                                /* [] */0
                              ]),
                          /* :: */[
                            Tea_html2.h2(undefined, undefined, /* :: */[
                                  Tea_html2.Attributes[/* class' */3]("hero-modal__title"),
                                  /* [] */0
                                ], /* :: */[
                                  Tea_html2.text("Host Game"),
                                  /* [] */0
                                ]),
                            /* :: */[
                              tmp,
                              /* :: */[
                                tmp$1,
                                /* [] */0
                              ]
                            ]
                          ]
                        ]),
                    /* :: */[
                      Tea_html2.div(undefined, undefined, /* :: */[
                            Tea_html2.Attributes[/* class' */3]("hero-modal__inner"),
                            /* [] */0
                          ], tmp$2),
                      /* [] */0
                    ]
                  ]),
              /* [] */0
            ]);
}

var partial_arg = window.__GAMES__;

function partial_arg_000(param) {
  var games = partial_arg;
  var decoded_games = Json_decode.array(Game.decode, Json.parseOrRaise(games));
  var games$1 = (function (param) {
        return Belt_Map.fromArray(param, CmpGameId);
      })($$Array.map((function (game) {
              return /* tuple */[
                      game[/* id */0],
                      game
                    ];
            }), decoded_games));
  var default_selected = decoded_games.length !== 0 ? Caml_option.some(Caml_array.caml_array_get(decoded_games, 0)[/* id */0]) : undefined;
  return /* tuple */[
          /* record */[
            /* games */games$1,
            /* selected_game */default_selected,
            /* config */default_config,
            /* valid_form */true,
            /* hosted_game_url : Idle */0,
            /* url_copied */false
          ],
          Tea_cmd.none
        ];
}

function partial_arg_003(param) {
  return Tea_sub.none;
}

var partial_arg$1 = /* record */[
  partial_arg_000,
  /* update */update,
  /* view */view,
  partial_arg_003
];

function main(param, param$1) {
  return Tea_app.standardProgram(partial_arg$1, param, param$1);
}

exports.main = main;
/* CmpGameId Not a pure module */
